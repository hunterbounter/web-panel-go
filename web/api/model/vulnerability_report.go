package model

import "hunterbounter.com/web-panel/pkg/database"

func GetVulnerabilityReport() []map[string]interface{} {

	var vulnerabilitySql = `
	select * from zap_scan_results t 
	
	order by t.url,t.risk  asc
`

	dbRecords, err := database.ExecuteSql(vulnerabilitySql)
	if err != nil {
		return nil
	}
	return dbRecords

}

func GetVulnerabilityById(id string) []map[string]interface{} {
	var vulnerabilitySql = `
	select * from zap_scan_results t where t.id =  ` + id + `
	order by t.url,t.risk  asc
`
	dbRecords, err := database.ExecuteSql(vulnerabilitySql)
	if err != nil {
		return nil
	}
	return dbRecords
}

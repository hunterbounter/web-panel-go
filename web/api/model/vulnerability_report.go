package model

import "hunterbounter.com/web-panel/pkg/database"

func GetVulnerabilityReportList() []map[string]interface{} {
	var vulnerabilitySql = `
	SELECT * FROM VULNERABILTY_REPORT_LIST order by  create_date DESC;
`

	dbRecords, err := database.ExecuteSql(vulnerabilitySql)
	if err != nil {
		return nil
	}
	return dbRecords
}

func GetZapVulnerabilityById(id string) []map[string]interface{} {
	var vulnerabilitySql = `
	select * from zap_scan_results t where t.id =  ` + id + `
	order by t.url,t.risk  asc
`
	dbRecords, err := database.ExecuteSql(vulnerabilitySql)
	if err != nil {
		return nil
	}
	return dbRecords
}

func GetOpenVASVulnerabilityById(id string) []map[string]interface{} {
	var vulnerabilitySql = `
	select * from openvas_scan_result t where t.id =  ` + id + `
	 
`
	dbRecords, err := database.ExecuteSql(vulnerabilitySql)
	if err != nil {
		return nil
	}
	return dbRecords
}

func GetNucleiVulnerabilityById(id string) []map[string]interface{} {
	var vulnerabilitySql = `
	select * from nuclei_scan_results t where t.id =  ` + id + `
	 
`
	dbRecords, err := database.ExecuteSql(vulnerabilitySql)
	if err != nil {
		return nil
	}
	return dbRecords
}
